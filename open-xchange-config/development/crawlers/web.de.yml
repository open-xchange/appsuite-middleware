--- !com.openexchange.subscribe.crawler.CrawlerDescription
crawlerApiVersion: 616
displayName: web.de
id: com.openexchange.subscribe.crawler.webde
priority: 2
workflowString: |
  --- !com.openexchange.subscribe.crawler.Workflow
  steps: 
    - !com.openexchange.subscribe.crawler.LoginPageByFormActionStep
      actionOfLoginForm: "https://login.web.de/intern/login/"
      baseUrl: ""
      description: Log in
      linkAvailableAfterLogin: "(\\/online\\/.*)"
      nameOfPasswordField: password
      nameOfUserField: username
      numberOfForm: 2
      pageTitleAfterLogin: "(\\/online\\/.*)"
      password: ""
      url: "http://web.de/fm/"
      username: ""
    - !com.openexchange.subscribe.crawler.ConditionalPageByLinkRegexStep
      description: Hit the link to web.de freemail if the user did not log out last time.
      url: "(/online/frame.*)"
    - !com.openexchange.subscribe.crawler.PageByLinkRegexStep
      description: Use the site without frames
      url: "/online/[^h]+.*"
    - !com.openexchange.subscribe.crawler.PageByLinkRegexStep
      description: This is a fancy page that does not appear in the browser.
      url: "/online/adressbuch/.*"
    - !com.openexchange.subscribe.crawler.PageByLinkRegexStep
      description: Go to the contacts list.
      url: "/online/adressbuch/.*"
    - !com.openexchange.subscribe.crawler.AnchorsByLinkRegexStep
      description: Get each contact.
      linkRegex: "adr_show.*"
      mayHaveEmptyOutput: true
      subpageLinkRegex: ""
    - !com.openexchange.subscribe.crawler.ContactObjectsByHTMLAnchorsAndPagePartSequenceStep
      description: Get the information of each contact from the individual webpages
      pageParts: !com.openexchange.subscribe.crawler.internal.PagePartSequence
        page: ""
        pageParts: 
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(width=\"282\"><b>)([a-zA-Z\\säöüß-]*)(<)"
            type: 1
            typeOfInfo: display_name
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: E\-Mail\-Adressen
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(<b>Privat</b></td><td class=\"b\" width=\"277\"><a href=[^>]*>)([a-z@A-Z0-9\\.\\-\\{\\}\\#\\|\\^\\$\\*\\+\\?\\'\\/!%&=_`~]*)(<)"
            type: 1
            typeOfInfo: email2
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(<b>B.ro</b></td><td class=\"b\" width=\"277\"><a href=[^>]*>)([a-z@A-Z0-9\\.\\-\\{\\}\\#\\|\\^\\$\\*\\+\\?\\'\\/!%&=_`~]*)(<)"
            type: 1
            typeOfInfo: email1
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: Telefonnummern
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(<b>Privat<\\/b><\\/td><td class=\"b\" width=\"277\">)([0-9\\s\\+\\-\\/\\(\\)]*)(<)"
            type: 1
            typeOfInfo: telephone_home1
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(<b>Mobil<\\/b><\\/td><td class=\"b\" width=\"277\">[^>]*>)([0-9\\s\\+\\-\\/\\(\\)]*)(<)"
            type: 1
            typeOfInfo: cellular_telephone1
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(<b>B.ro<\\/b><\\/td><td class=\"b\" width=\"277\">)([0-9\\s\\+\\-\\/\\(\\)]*)(<)"
            type: 1
            typeOfInfo: telephone_business1
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: Adressen
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(<b>Privat<\\/b><\\/td><td class=\"b\" width=\"507\">)([^<]*)(<br)"
            type: 1
            typeOfInfo: street_home
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(>)([0-9]*)()"
            type: 1
            typeOfInfo: postal_code_home
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "()([a-zA-Zäöü]*)(<br)"
            type: 1
            typeOfInfo: city_home
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(>)([a-zA-Zäöü]*)(<\\/td>)"
            type: 1
            typeOfInfo: country_home
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(<b>B.ro<\\/b><\\/td><td class=\"b\" width=\"507\">)([^<]*)(<br)"
            type: 1
            typeOfInfo: street_business
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(>)([0-9]*)()"
            type: 1
            typeOfInfo: postal_code_business
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "()([a-zA-Zäöü]*)(<br)"
            type: 1
            typeOfInfo: city_business
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(>)([a-zA-Zäöü]*)(<\\/td>)"
            type: 1
            typeOfInfo: country_business
  useThreadedRefreshHandler: true
  
