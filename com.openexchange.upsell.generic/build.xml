<project name="com.openexchange.upsell.generic" default="install" basedir=".">

    <description>
        Open-Xchange Upsell Generic
    </description>

    <!-- Customizable values -->
    <property name="destdir" value=""/>
    <property name="prefix" value="/opt/open-xchange"/>
    <property name="guiprefix" value="/var/www/ox6" />

    <!-- Constants -->
    <property name="tmp.dir" value="tmp"/>
    
   	<property file="META-INF/MANIFEST.MF" />
	<property file="build.properties" />
    
    <!-- Install Constants -->
	<property name="guipluginsdir" value="${guiprefix}/plugins" />

	<property name="version" value="${Bundle-Version}"/>
	<property name="bundle.name" value="${Bundle-SymbolicName}.jar" />
	<property name="composite.name" value="open-xchange-upsell-generic-${version}" />

    <!-- Replacements -->
    <property name="conf.install.dir" value="${prefix}/etc/groupware"/>
    <property name="conf.install.copy.dir" location="${destdir}${conf.install.dir}"/>
    
    <!-- Install -->
	<target name="installConfig">
		<copy todir="${destdir}/${prefix}/etc/groupware/settings/" overwrite="true">
			<fileset dir="conf" />
		</copy>
	</target>

	<target name="installGui">
		<mkdir dir="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}" />
		<copy todir="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}" overwrite="true">
			<fileset dir="js" />
		</copy>
	</target>

    <target name="install" depends="installConfig,installGui"/>

	<!-- Dist -->
	<target name="dist" depends="clean">
		<property name="dist-package" value="dist-package"/>
    	<delete dir="${dist-package}"/>
        <mkdir dir="${dist-package}/${composite.name}"/>
        <copy todir="${dist-package}/${composite.name}">
            <fileset dir=".">
                <exclude name="**${dist-package}/**"/>
                <exclude name="**debian/**"/>
                <exclude name="**CVS/**"/>
                <exclude name="Todo"/>
            </fileset>
        </copy>
        <tar destfile="../${composite.name}.tar.gz"
	        basedir="${dist-package}"
    	    includes="${composite.name}/"
         	compression="gzip"/>    	<!-- dpkg-source does not like anything else -->
    	<delete dir="${dist-package}"/>
    </target>

    <target name="clean">
        <delete dir="${output..}"/>
        <delete dir="${tmp.dir}"/>
    </target>

</project>
