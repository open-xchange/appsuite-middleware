/*
 *
 *    OPEN-XCHANGE legal information
 *
 *    All intellectual property rights in the Software are protected by
 *    international copyright laws.
 *
 *
 *    In some countries OX, OX Open-Xchange, open xchange and OXtender
 *    as well as the corresponding Logos OX Open-Xchange and OX are registered
 *    trademarks of the OX Software GmbH group of companies.
 *    The use of the Logos is not covered by the GNU General Public License.
 *    Instead, you are allowed to use these Logos according to the terms and
 *    conditions of the Creative Commons License, Version 2.5, Attribution,
 *    Non-commercial, ShareAlike, and the interpretation of the term
 *    Non-commercial applicable to the aforementioned license is published
 *    on the web site http://www.open-xchange.com/EN/legal/index.html.
 *
 *    Please make sure that third-party modules and libraries are used
 *    according to their respective licenses.
 *
 *    Any modifications to this package must retain all copyright notices
 *    of the original copyright holder(s) for the original code used.
 *
 *    After any such modifications, the original and derivative code shall remain
 *    under the copyright of the copyright holder(s) and/or original author(s)per
 *    the Attribution and Assignment Agreement that can be located at
 *    http://www.open-xchange.com/EN/developer/. The contributing author shall be
 *    given Attribution for the derivative code and a license granting use.
 *
 *     Copyright (C) 2016-2020 OX Software GmbH
 *     Mail: info@open-xchange.com
 *
 *
 *     This program is free software; you can redistribute it and/or modify it
 *     under the terms of the GNU General Public License, Version 2 as published
 *     by the Free Software Foundation.
 *
 *     This program is distributed in the hope that it will be useful, but
 *     WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 *     or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
 *     for more details.
 *
 *     You should have received a copy of the GNU General Public License along
 *     with this program; if not, write to the Free Software Foundation, Inc., 59
 *     Temple Place, Suite 330, Boston, MA 02111-1307 USA
 *
 */

package com.openexchange.imap.threadsort2;

import java.util.List;
import junit.framework.TestCase;
import com.openexchange.mail.dataobjects.MailMessage;


/**
 * {@link ThreadSortsTest}
 *
 * @author <a href="mailto:thorben.betten@open-xchange.com">Thorben Betten</a>
 */
public class ThreadSortsTest extends TestCase {

    /**
     * Initializes a new {@link ThreadSortsTest}.
     */
    public ThreadSortsTest() {
        super();
    }

    public void testParseConversations() {
        try {
            String s = "* THREAD ((2000)(1999)(1996 (1994 1992)(1991))(1993)(1987)(1983 (1960)(1953))(1878 1802 (1801 1799 (1794 1790 1787 1785)(1792 1791 1788 1786))(1664 (1663 1656 (1653 1643)(1651 (1647 (1640)(1603 (1575)(1573)))(1642 1620)))(1662)(1661 1621 1619 1618)))(1638 1622))(1998 1997)((1995 1971)(1970))((1990)(1967 1956))((1989 1978 (1959 (1928 1921)(1897))(1898 1885))(1985))(1988)(1986)((1984 (1966)(1965)(1944)(1934))(1917))(1982 1980 1969 (1968 1722 1719)(1875 1716 1626 1508))(1981 1972)((1979)(1923 1826))(1977 (1950 (1943 1941)(1933))(1949 (1930 1869)(1905 1865 1864 1851))(1870))(1976 1904)(1975 1925 1913)(1974)(1973 1924 (1912)(1891))(1964 (1948 (1947 1946 1940)(1945))(1939 1936))(1963 (1937 1873)(1931 1874 1844 1800 1795 1783)(1922 (1916 1871)(1872)))(1962 (1938)(1932 1806 1751 1733))(1961)((1958 (1951)(1942 1935))(1957 1929 1906 1880 (1879)(1868 1856 (1853 1772 1744)(1852 1760 1711))))(1955 1927)(1954 1920 1907 1867 1866 1863)(1952)(1926 1919 1914)((1918 (1915 1911 (1910)(1894 1854)(1606 1598 (1591 (1588 1304 (1298)(1297 1250 (1247)(1246)(1239 1236)(1199))(1295)(1257))(1584)(1551 1550)(1544))(1583)))(1895 1607))(1767 (1613)(1608 1600 (1595)(1590)))(1763)(1605 (1601 (1593 (1578 1543 1496 (1491 (1484)(1448))(1450))(1552 1470 (1453 1403 1372)(1452 (1449 (1447)(1415))(1446 1445 (1444 1442 (1433 1431)(1413))(1414))(1440 1416))))(1586 1577 1549 (1545)(1524 1523)))(1594)(1502))(1602))(1908 1909)(1903)(1902 (1900 1888 1887 1886 (1884)(1883))(1899)(1896 1890 1889 1793 1776))(1901 (1841 1781 1779 1746)(1835 1782 1712))(1893 1882 1778)(1892)(1881 1834 1761 1709)(1877 1876)(1862 (1860)(1859)(1833)(1609))(1861 (1858 1857)(1855 1849 (1846)(1742)(1741)))(1850 (1848 (1847)(1842))(1839 1838 1836 1825 1804))(1845 1840 (1837)(1832 (1815)(1797 1659 1658 1657 1655 1649 (1646)(1645 1639))))(1843 (1770)(1764))(1831 1830 (1829 1823 1820 1812 1780)(1828 1827 (1824 1821 (1819)(1775))(1805)))(1822 1818 (1816 1811 1773)(1814 1813 935))(1817 (1809)(1803))(1810 1774)(1808)(1807 (1796)(1789)(1723))(1798)(1784)(1777)((1771 1762)(1759)(1739))((1769 (1766)(1765 1757 1756 1755))(1754))(1768)(1758)(1753)(1752 1713 1696)(1750)(1749 1748 1740 1644)(1747 (1745)(1743)(1732)(1547 (1546 1529)(1532)(1480 1478 1475 (1466)(1459 (1457 1299)(1451))))(1514))(1738 (1737 1735 (1725 (1724 (1700)(1675))(1665 1652 1637))(1654))(1702)(1541 1434 1421)(1418))(1736 (1734 1728 (1721 1718 1705 (1682 1634 (1612 1611)(1560))(1633 1632))(1720 1670 1627))(1729 1726 (1717 1706)(1708 (1703)(1699 1681))))((1731 (1714 1704 (1701 1695 (1684)(1679))(1698 1694 1678 1676)(1680)(1526 1503 (1501)(1488 (1487 1481 (1477 1474 1467)(1476 1473 1471))(1468))))(1674 1525 (1517 1500 (1490)(1485))(1512 (1507 1505)(1499)))(1497 1494))(1461 1454 1438))(1730 (1715)(1707))(1727 1168)(1710)(1697)((1693 1161 1116)(1692 1672))(1691 (1689)(1685 1134))((1690)(1688)(1687)(1686)(1677 1636 1616 1610 1589 1585 1582 (1569)(1568 1423)))(1683 869 868 (867)(866))(1673 (1671 1668)(1669 1667 1599)(1666)(1660))(1650)(1648 1635 1597)(1641 (1631)(1623 1614)(1615))(1630 (1629 1580 1567 1566 1565 1564 1561)(1628 1576 (1548)(1528))(1625)(1624 (1617 1572)(1574)(1571)))(1604 (1579)(1540 1533))(1596 (1592)(1587 (1581)(1570 1563 (1554)(1553))))(1562 (1557)(1542))(1559 (1558)(1556)(1555))(1539 1538 1535)(1537 (1536)(1534 1531 1520))(1530 1527)((1521 (1518)(1516 1511 (1506)(1463 1456)(1441 1402))(1513)(1498 1482))(1522))(1519 (1515 766)(1510))(1509)(1504 1173)(1495 (1493 1489 1483 1469)(1492)(1465 1464))(1486)(1472 1479 1462)(1460)(1458 (1455)(1443)(1334))(1439 (1437 1313 1231 1217 1163)(1436 1432 1314))(1435 (1430 1425)(1426)(1422 1419 1332))((1429 (1428)(1427)(1424))(1354))(1420 1169)(1417)(1412 1411 (1410 1408 (1407)(1400 (1396)(1390)))(1409 (1406 (1399 1398 1397 1395 (1394)(1352 1342))(1383 (1382 1376)(1381 1377 (1374 1340 1338)(1373 1371 1369 (1368)(1367 (1365 1361 (1356)(1355))(1350 1349 (1348 (1345)(1328 (1326)(1319)))(1347 1344)))(1329 (1324 1323 1322 1316 (1311 1288 1282 (1273 (1272)(1267 1265))(1268 (1266)(1233 (1222 1219)(1203 1192 1073 1069 1038))))(1309 1287))(1318 1317)))(1341 1339))))(1401 (1393 1392 1391)(1380))))(1405 1404)(1389 (1384)(1351))(1388 1386 1385)(1387 (1360)(1333)(1238))(1379 (1378 1358)(1375))(1370 (1366 1364)(1343 1327))((1363 1170)(1362 (1359)(1357)(1346 1148)))(1353 (1310 1289 1255)(1308))(1337 (1336 1325 1296)(1335)(1331))(1330 (1312)(1260))(1321 (1315 1060)(1290 1058 1051 1048)(1055))(1320)(1307)(1306 (1305 1303)(1302)(1301 1294)(1277)(1213 1194))(1300 (1293)(1292)(1284 1274 1271 1229)(1221 1210 1082 1035 883 865 (861)(840)))(1291 (1286 1283 1281 1046 1047)(1285 1278)(1280 1270))(1279 (1276)(1275 1269 1263 1258))(1264 (1261)(1248)(1230))(1262)(1259 1245 1243)(1256 (1254 (1225 1177 (1175)(1174 1172 1159)(1166 1155 1151))(1218))(1253))(1252 (1251)(1242))(1249 1240)(1244 (1232)(1224 (1204 (1197)(1180))(1181 (1179 876)(1178 1176)))(1202))(1241 (1227 (1223)(1212))(1149))(1237 1234 1171 1165 1084)(1235)(1228 1226)(1220 1216 1214 1211)(1215)(1209 1207 1206)(1208 (1205)(1201)(1200 1198 1167))(1196 (1195 1193 1184 (1183)(1182 1164 1162 1141 1130 1126))(1186))(1191 (1190)(1189)(1188)(1187)(1185)(1145 1144 1135))(1160 1044 1017 1004)(1158 (1157 998 (996 952)(973)(943 938 930 928))(1156 1154)(1153 401 (402)(400 397)(398))(1152)(953)(455))(1150 1079 1078 (1076)(1070 1061 1052 838 831))(1147 1146 1143 1142 1133 1121 1095 1077 1067)(1140 (1139)(1138 1030 1020 958 (956)(940 (936 908 907 904 899 891 889 887 (886)(878 823))(856 855))))(1137 1136 1122)(1132 (1129 1125 1100 1028)(1127 1124 (1120)(1119 1026 1023 999)))(1131 (493)(491)(490)(482)(452 443)(393)(332))(1128 1123)(1118 (1117)(1114 (1113 (1111 1108)(1110 (1109)(1107 1101 (1097)(1081 1072))))(1112))(1096 1088 1086 1050 1045 (1043 1029 1024)(1016 1015 1010)))(1115 1104 1099 (1098)(1083 (1066)(1009 1005 997 955 954))(1068)(1049))(1106)(1105 (1103)(1074 1065))(1102 576)(1094 (1092)(1091 (1090)(1087)(1063))(1089 (1062 1057)(1056))(1085))(1093 (1071)(1053))(1080 1064 1032)(1075 12)(1059 1054)(1042)(1041 (1037 1022)(932))(1040 (1034)(1033)(1031 (1027)(967 (966)(575 556 503 (501 481 453)(454))))(934 (929)(897)))(1039 (1036 1025)(1021 881)(1019)(1001))(1018 (1014)(1013 1012 (1008)(1002 950))(1011))(1007 1006 (1003 990)(933))(1000 (951 924)(942))(995 (993)(992)(982)(970)(969))(994 (562 (558 551)(425))(315))(991 (989)(986))(988 (987 980 (979 (977 963 962 (961)(960 946)(949 947))(975))(971 (968)(923 911))(919 917))(957))(985 (984)(983))(981 978 (976 965 931)(974 972))(964 959)(948)(945 (944 926 880 833 824 749 (746 (741 (738)(728))(729))(743))(941 (939 884 789 778 747 742)(925 916))(722))(937 (492 (488)(478)(460)(385 381 (368)(344)))(489))(927 885 714)(922 (921 (915 (913 910 909)(912))(914))(906))(920)(918)(905 (498)(486 484 470 448 (426)(287)))(903 901 863)(902 (894)(790)(727 (718 (716 703 695)(708 702 (701 691)(700 693)))(717))(719))(900 (898 893)(896)(895 892 882 877 799 798 797 757)(890)(888))(879 (875 873)(872)(847 835))(874 844 822 756 736)(871 864)(870 (859)(837)(788)(787))(862 (860)(858 829 745)(821))(857 (853 849 848 (846 845 820)(801))(851 841 795)(850 709)(842)(802)(796))(854)(852 (843)(834 832))(839)(836 726)(830 828)(827 (825)(819)(713))(826 (494)(440))((818)(817 808 807 805)(816)(815)(814)(803)(759 (758)(754 424)(740 697 694 678))(752)(739 724 723))(813)(812 (809)(806 804 776 774))(811 810)(800 (794)(792 (751 (715)(434))(733)))(793 770)(791 734)(786 (785 777)(710)(699 698))(784 (783 780 779 775 773)(781 748))((782)(760 633))(772 (768 767 (765)(764 762))(763))(771 761 755)(769 (731 725)(704))(753 737 681 679)(750 721 706)(744)(735 720 712 707 696)(732)((730 711 685)(312 81 60)(146 (133)(78 42)))(705)(692 (690 (687 (686 625)(626 611 609 605))(627 (623)(600)))(689)(688 (684)(619))(618)(427 407 391))(683 (677)(673 504))(682 (680)(676 (675 422)(674)(646))(672 671 (670)(669 668 657))(655)(637))(667 (666)(665 (663)(652))(659)(658 612)(656 653)(650)(649 (620)(590 (589 442)(513)))(648 610 (603 (602 (597 592)(569))(593))(601)(525)(337 321))(441 372 367 366))(664)(662 661)(660 (645 642 639)(636 631))(654)(651 (635 (634)(630))(628)(617 599 587 577))(647 (644)(641)(638))(643 640 632 629)(624)(622 621 548 (544)(541))(616 (615 596 584 583 (581 580 518 514)(568)(543 540 538 523))(550 515))(614 613 511)(608 (607)(533)(521))(606 604)(598 595 594 588 557 555 502 (500)(499 497 382 (380 378)(341 330 319)))(591 (586)(585))(582 (554)(531 524))(574 (573)(572)(565)(564 (563)(546))(529)(522))(571 567 507 (479)(439))(570 566 537 516 (512)(473 451 438 436 (428 417 415)(409 (371 (356)(340))(358 (343)(339 320)))))(561)(560 (495 487)(477 474 (463)(456 450 (447)(444 420 (412 410)(396 (392 386)(390)))(411 (406 384)(405 357))))(437))(549 547 545)(542 (536 534 (530)(517))(528 429 (416)(408))(383 379 (377)(376))(317)(169))(539 (579 532 527 526)(578 519)(559 553)(552)(510)(509 (508)(506 505)))(535 520)(496 472 465)(485 (483)(480)(476)(475)(467 457)(363))(471 469 466 464 446 435 430)(468)(462 461 (459)(458)(418))(449 (445 360)(389 361 359 353 (348 309)(346 308 156)(345 305)))(433 (432)(431 419 252 204 174 153))(423 414)(421)(413)(404 (403)(394 355 336))(399 (395)(387))(388)(375 (176)(172))(374)(373 352 318 (316)(314))(370 (369 349 347)(350))(365)(364)(362 (354)(351)(342)(338 254)(335 334 333)(325 322)(313))(331 (329 306 291 (288)(286 185 (183 154)(178 152)))(328)(293 289 248 184 151 (150)(147 138)))(327 (326)(324))(323)(311 (310 285)(227)(34))(307 303 302)(304 (296)(212)(209))(301 (295 294 283 (282 281 278)(266 (255 (253 251)(239 230))(243)))(269))(300 (298)(290 284 280 179 175)(268 250 (245)(240 231)(216 215 208)))(299 274 260 (258)(246 (244 (241 236)(237))(238)))(297)(292 (275)(272)(267))(279 (206 (199 (197 194 193 163 131)(136 85))(164 162 (158)(130 (129)(128 124 122 (121 120)(115))(126))))(201 141 135)(200 187 180)(198 166 132))(277 276)(273 (271 182)(270 259 (257 249 233 214)(256))(265 262))(264 234)(263 79)(261)(247 (225)(218 125 110))(242 (203 143)(195))(235)(232 (229)(228))(226)((224 (223 222)(221 (220)(219)))(211))(217 213)(210)(207)(205)(202 (161)(157))(196 (190 170)(144))(192 189 186 92)(191 (188)(181)(177 167 165 159 155))(173 171)(168)(160 140 89)(149 (145)(142))(148 84 57)(139 (137 (134 127 119 (118 (114)(113 97 (94)(90 87)(86 55)))(116)(111 (107)(53 26)))(91 83))(117 52)(96))(123)(112 (109)(104 102 88)(67))(108)(106 (105 101 100 (99 93)(76 75 (74 48)(46)))(103 47))(98 (59 30 29 (28 (25)(24 (23)(17)))(27 14))(3 1))(95)(82)((73)(54 40))((72)(69 49 38))((71)(70 (68 36)(65 37)))(66)(64 (63 (80 44)(62 77 (56)(43 39))(61 45))(58))(51 33 31)(50 (41)(35))(32)(22 (21 20 13 11 10 9)(19 16))(18 15)(8 5)(7 6 4)(2)(3620 3586)(3619 3611 3604 3601 3599)((3618 3603 3511)(3598 (3594)(3550 3548 3546)))(3617 (3616 3615 (3614 3613)(3609))(3610))(3612)(3608 3607 3595)(3606 (3605)(3602))(3600 3580)(3597 (3596 3589 (3570)(3549))(3590 3564)(3540)(3539))(3593 3077 2916 2488)(3592 (3591 3583 3578 3577 (3576)(3573)(3572 3533 3532))(3545 3544 3543))(3588 (3587 3584)(3504 3449 3438))(3585 3582 3579)(3581 3575 (3574 3571)(3559))(3569)(3568)(3567)(3566 (3560)(3392 3339))(3565)(3563 (3526 3523)(3525))(3562 (3561)(3558 3556)(3557 3555 (3554)(3553 (3551)(3538 (3537 (3535 3521)(3515 (3513 (3510)(3478))(3412 3407)))(3536)))))(3552 3541)(3547 (3542)(3326))(3534 (3079 (3074 (3071)(3056))(3070 3008 2986))(3073 3057 3038)(3067))(3531 (3528)(3527)(3508 3486 3474 (3473)(3472 3462 3461 3403 3400 (3389 (3364)(3357))(3367 3358 (3337)(3335)))))(3530 3529)(3524 (3509)(3506 3498)(3484))(3522 3514)((3520 (3519 3518 (3517)(3516))(3319))(3503 3447 (3442)(3380)))(3512)(3507 3466 (3446 3433)(3426 3425 3397 3352))(3505 3485)(3502 3501)(3500 (3499 (3497)(3482 3471 3470))(3483 (3481 3479 3477)(3476 3475 (3469 (3468)(3467 3454))(3463 (3453 3431)(3390 3383 (3373)(3347))))))(3496 (3495)(3494 3493 (3489 3488 3455)(3487 3356))(3492 3491 3490 3448)(3458))(3480 3303)(3465 3456)(3464 (3078)(3076 3027)(3075)(3002 2906)(3000)(2999))(3460)(3459 3024)(3457)(3452 3451 3385 3384)(3450 3445 3444 3443 3429 3427)(3441 3081)(3440 3439)(3437 (3436)(3435 3424)(3434)(3432 3421)(3423 3419)(3418 (3417 3365 3316)(3416)(3415)))((3430 (3340)(3318))(3324 (3302)(3287))(3258 3257 3248))(3428)(3422 (3420)(2649))(3414 (3413)(3411 3379 (3372 (3369)(3362))(3353)(3344))(3350)(3338 3333)(3330))(3410 (3409 3408 (3406)(3405))(3386 (3377)(3371 3368 3366)))(3404 3398 3396)(3402 (3401)(3399 3370 3355 (3354)(3346))(3393)(3391)(3388 (3378 3349)(3363))(3361))(3395 (3394)(3387)(3382)(3374))(3381 3320)(3376 3375 3237)(3360 3359 3345 3332 (3322)(3212 3210 3209))(3351 (3348)(3342))(3343)(3341)(3336 (3334)(3331)(3315 3120))((3329)(3184 3183 3152 3121 3119 3085))((3328 (3325 3323 3317 (3314)(3304 (3294 (3288)(3217))(3289 (3283 3272)(3282))))(3313 3305)(3308 3298 3279 (3278 3277)(3276 3275 3273)(3216))(3307)(3291))(3327 3290))(3321 3286 (3280)(3207))(3312 (3310)(3309)(3306 3300 3240 3239 3202 3200))(3311)(3301 3299 (3255 3242)(3252 3241 3208))(3297 (3295 3293)(3281))(3296 (3285)(3284 3176))(3292)(3274 (3256 3249 3229)(3227))(3271 (3270 3269 3268)(3260 (3259)(3218 (3215)(3189)))(3236))(3267 (3080)(3072))(3266 3265)(3264 3250)(3263 (3261)(3175)(3174)(3173))(3262 3061)(3254)(3253 (3251 3245 3232 3226 (3225)(3224 (3223 3222)(3221 (3220 3219 3213)(3178))))(3188))(3247 3246)(3244 (3243 3197)(3164 (3159)(2951)))(3238 (3235 3233)(3234))(3231 3230 3228)(3214 (3211)(3205)(3147))(3206)(3204 (3203 (3199 (3187 3158 3157)(3169 (3167 3151)(3156)))(3198))(3201)(3196 3168 (3165)(3155))(2965 2955)(2898 2856 2800 2794))(3195 3193 3192 3191)(3194 (3082 2639 2627)(3065 3064 2637))(3190)(3186 3185 3182 3179 3177 3083)(3181 (3172)(3170 3146)(3125 (3122)(3095))(3115)(3093)(3090 (3053)(3051))(3023)(3022 (3017 2993)(3013)))(3180)(3171)(3166 (3163)(3162 3161)(3160)(3154 3153))(3150 (3149)(3084))(3148)(3145 3144 3141 3139)(3143 (3142 3140 (3138 (3136)(3129 3126 3114))(3135))(3100 3098))(3137 3132 3108 (3107 3106 3105 3089 (3086)(3058 (3032 2944)(2988 2949)))(3092)(3025))(3134 3097)(3133 (3127 3118 3117 3116 3087 3055 3054 3050 3049 3048 3047 (3046 3044 3043 3042)(3040))(3037 3033 3029 3026)(3036))(3131 3001)(3130 (3128)(3113))(3124)(3123)((3109)(3110)(3111)(3112 2753))(3104 (3102 3101)(3099 3096 3094 3088))(3103)(3091)((3069)(2908 2903))(3068 (3059 3052 (3041 3035)(3039 (3019 (3015 2992 2910)(3014 3010 3006 2984 (2983 2981)(2393 2381 2373 2215 2211 2196 2188 2148))(2977 (2973)(2670 2636)))(2952))(2953))(2929 2928))(3066 (3063 3060 3007 2985)(2748 2676 2654 2644))(3062)(3045 3031)(3034 2943)(3030 2823)(3028 2013)(3021 3018 2941)(3020)(3016 (3012 3011)(3009 (3005)(3004 3003 2998 2997))(2960))(2996 (2995 2991)(2982))(2994 (2990)(2989 2987 2817)(2940))(2980 (2979 2964)(2978 2967 (2966 2963)(2961 2844 2842 2835 2759 2758 2739 2729 2727 (2726)(2725)(2720 2562 (2551)(2526)(2324))(2718)))(2962)(2661 (2474)(2470 2431 2317 2309 2306 2295)))(2976 2975 2974 2972 2970 2969 2968 2920 (2899)(2469 2388)(2235))(2971 (2954)(2950 (2947)(2945 (2942)(2939)(2938 2935))))(2959 2958)(2957 2904)(2956 2922 2897)(2948 2946 2936 2934 2931 2930)(2937 2933 2932 (2927 2850)(2926 2925 2846 (2831)(2821)))(2924 (2923)(2921)(2919)(2909 2907))(2918 (2917)(2915 2914)(2913)(2912))(2911 (2901)(2874)(2757))(2905 (2902)(2883)(2871)(2781))(2900 2866)(2896)(2895)(2894 (2893 (2892)(2889 (2887)(2876 (2873 (2869 2867 2858)(2863))(2870)(2864))))(2890 2888 2885 2882 2877)(2879 2868 2696))(2891 2886 2884 (2881)(2880 2872))(2878 (2875 (2865 (2862 2860 2363)(2857 2853 (2851 2848 (2843 (2836 (2830)(2792)(2786)(2785))(2797)(2793))(2798 (2790 2782 2460 (2455)(2437)(2315 2194 2193))(2787)))(2828))(2829 2791))(2799 2795 2789 2784))(2822))(2861)(2859 2854 2849 2847 2845)(2855 2333)(2852)(2841 (2840 2837)(2838)(2827)(2755 2707))(2839 (2833 2832 2561 (2560)(2558 2543))(2749))(2834 (2825 (2818 2803 (2788 2780 2778)(2783)(2701)(2695))(2692))(2752))(2826 (2816 2814)(2815 2813 2812)(2808))(2824)(2820)(2819)(2811 (2809 2807)(2806)(2804))(2810)(2805 (2766 2516 2506)(2762))(2802 (2657)(2656))(2801)(2796 (2690)(2688))(2779 (2776 (2773 2769 2767 2719)(2765 2770 (2745)(2734 2733 (2724)(2717))))(2775))(2777 2774 2772 2771 2768 2764)(2763 2750)(2761)(2760 (2747 (2744)(2743 2730 2708)(2732 (2714 2698)(2697 (2693 (2685)(2454))(2680 2653 2650 (2628)(2587 2571 2452 (2442)(2367)(2355))))(2691)))(2658)(2616 2578 (2577 2529)(2576 (2575 (2570)(2569 2563))(2537 (2535 (2528 2527)(2503)(2451))(2524 (2522)(2507))(2513 2496)(2476)))(2530 2449)(2482 (2457)(2369)))(2483))(2756 2751)(2754 2664)(2746 (2731 2722 2715 2712 2705)(2704 2702))(2742 2741 2740 2736 2735)(2738 (2737)(2728)(2699))(2723)(2721 (2716 2713 2703)(2711))(2710 2709 2706)(2700 (2665)(2662)(2660)(2652 2642)(2629)(2625)(2323 2320 2319)(2314)(2312 2311))(2694 (2683 2671 (2668 2604)(2663 2613 2590 (2586 2574 2573 2568 2538)(2584)))(2682 (2681)(2679))(2572)(2567 2368)(2550 (2525)(2321 2092 2014))(2517 2514)(2510)(2505 2502)(2490)(2486 (2462)(2458)(2093))(2461 2450 2448 2438)(2447)(2446 2445)(2428 2425)(2417 2415)(2404 2401)(2353 2343))(2689 2687)(2686 2640)(2684 (2666 2648)(2659))(2678 2655 2209 2208)(2677 (2675 2674 2632)(2673 2667)(2599 2592))(2672)(2669 2643)(2651 (2645)(2641)(2552)(2466))(2647 (2646)(2544 2542))(2638)(2635 (2634)(2633 2620)(2630 2623 2621 2615 2611))(2631 2626 2598 2515 2426 2375 2281 2265)(2624 (2622 2617 2614 (2612 2610 2609 2605)(2608 2607 2606 2596 2591 2589))(2619)(2618))(2603)(2602 2601 2600)(2597 (2583)(2478))((2595)(2594))((2593 2588)(2501 2491 2475))(2585 (2582)(2581 (2580 2579 2119)(2120))(2555))(2566 (2565 2559 2365)(2564 2557 2536)(2360))(2556 (2554 2549 (2548 (2540)(2322))(2546))(2553)(2533 (2531)(2523)))(2547 (2545 2541 2493)(2481))(2539)(2534 (2532)(2465))(2521 (2519 2509)(2518 2489)(2512 2500 2497)(2511)(2499 (2495 2494 2473 2436)(2492 2468))(2410 2378)(2395))(2520 (2034)(2003))(2508 2504 2498 2464 2463)(2487 2370 2019)(2485 2480 2479)(2484 2471)(2477 2467 2379 (2327)(2316))(2472)(2459 (2456 (2453)(2382))(2444)(2443 (2441)(2440 2432 2429)(2439)(2434 2422 2407)(2419 2326))(2416)(2301 2237 2236 (2234)(2233 2228 2227 2226)))(2435 2330 2313 2293)(2433 (2430 2418 2412 (2411 (2406)(2398))(2400))(2427 (2424 2409 2397 2396 2285)(2423 (2420 2405 2399)(2414))(2421))(2413 2403 (2394 2392 2389 2383 2380 2372 2371 2366 2364 2361 2359 (2332)(2304 (2302)(2299 2294 2262)))(2390 (2376)(2283 2264)))(2349 2305)(2258)(2244))(2408)(2402 2207)(2391 2385 2210)(2387)(2386 (2384 2374)(2377))(2362 2346)(2357 (2354 2298)(2328 2297))(2358 (2356)(2340)(2336 2331 2308 2300)(2303 2277))(2352 (2351 2252 2251 2205)(2318 (2310 2260)(2256 (2255 2206 2102)(2245))))(2350 2348 2279)(2347 2344 2342)(2345 2307 2296)(2341 2339 (2338 2329 2325)(2334))(2337 2335)(2292 (2291 (2290)(2288 2282)(2280))(2289)(2287)(2286)(2284 2278 2276)(2275 2271)(2274)(2273)(2248 2247 2232 2223 2217 2179)(2177 (2048)(2047))(2164))(2272 (2270 2269)(2268)(2267 2263)(2266 (2038)(2004))(2261 2257)(2259)(2254 2250)(2249))(2253)(2246 2238 (2231 2224)(2204))(2243 2239 (2230 (2192)(2187 2175 2173))(2216))(2242)(2241 2229 2103)(2240)(2225 2222 2221 2220 2214 2202 2200)(2219 2218)(2213 2212)(2203 2201 2197 2195 2190 2189)(2199 2198)(2191 2112)(2186 (2184 2182)(2183 2181 (2180)(2178))(2176))(2185 2111 2057 2056)(2174 (2171)(2170 (2167 2165 2163)(2166))(2168))(2172 (2157 2141)(2155 (2153 (2145)(2140)(2122))(2152 2151 (2149)(2138)))(2147 (2146)(2137)(2109)(2091))(2144 (2143)(2136)(2108))(2139 2126 2117))(2169 2162 2161 2154 2135 2133 (2131)(2130 2128 2127 2123 2121))(2160 (2116)(2115 2106 2105 2097 2067 2051))(2159 (2156 2150)(2113))(2158)(2142)(2134 2125 2124 2104)(2132 2026)(2129 (2027)(2020))(2118 (2045 (2017)(2006))(2024 2016))(2114 2090 2050)(2110 2060)(2107 (2098)(2059)(2042)(2022))(2101 (2100)(2099)(2062))(2096 (2088 2083 2055)(2082 2069)(2080 2068))(2095)(2094 (2089 2079)(2087 2086 (2084 2081 2076 2066)(2077)(2075))(2085 2073 2071)(2078 2074)(2072 (2070)(2065 2046 2043))(2064)(2033))(2063)(2061)(2058)(2054)(2053 2037 2021 2012 2007)(2052)(2049 (2030)(2002))(2044 2018)(2041 2040 2039 2023)(2036 2035 2031 2028)(2025 2032 2029)";

            List<List<MailMessage>> conversations = ThreadSorts.parseConversations(s, "INBOX");

            assertEquals("Unpected number of conversations", 578, conversations.size());

            List<? extends MailMessage> firstConversation = conversations.get(0);
            assertEquals("Unpected number of conversation size", 43, firstConversation.size());
        } catch (Exception e) {
            e.printStackTrace();
            fail(e.getMessage());
        }
    }

}
