--- !com.openexchange.subscribe.crawler.CrawlerDescription
crawlerApiVersion: 618
displayName: msn.de
id: com.openexchange.subscribe.crawler.msn.de
javascriptEnabled: true
mobileUserAgentEnabled: true
multiThreadedHttpConnectionManager: true
priority: 3
workflowString: |
  --- !com.openexchange.subscribe.crawler.Workflow
  enableJavascript: true
  mobileUserAgent: true
  multiThreadedHttpConnectionManager: true
  steps: 
    - !com.openexchange.subscribe.crawler.LoginPageByFormActionStep
      actionOfLoginForm: login.aspx
      baseUrl: ""
      description: Log into the mobile version as the full one does not work
      linkAvailableAfterLogin: ".*allservices.*"
      nameOfPasswordField: PasswordTextBox
      nameOfSubmit: PasswordSubmit
      nameOfUserField: LoginTextBox
      numberOfForm: 1
      pageTitleAfterLogin: ".*allservices.*"
      password: ""
      url: "https://mid.live.com/si/login.aspx"
      username: ""
    - !com.openexchange.subscribe.crawler.PageByLinkRegexStep
      description: "Click on 'All services'"
      url: ".*allservices.*"
    - !com.openexchange.subscribe.crawler.PageByUrlStep
      description: Open Contacts
      url: "http://profile.live.com/contacts"
    - !com.openexchange.subscribe.crawler.AnchorsByLinkRegexStep
      description: "Get all contact links. this is just one long list, no subpages here"
      identifyingCriteria: ".*contactId=(.*)"
      linkRegex: ".*contactId.*"
      mayHaveEmptyOutput: true
      subpageLinkRegex: ""
    - !com.openexchange.subscribe.crawler.ContactObjectsByHTMLAnchorsAndPagePartSequenceStep
      description: Get the information of each contact from the individual webpages
      pageParts: !com.openexchange.subscribe.crawler.internal.PagePartSequence
        page: ""
        pageParts: 
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(id=\"ic2_name\"\\s*title=\")([^\"]*)(\")"
            type: 1
            typeOfInfo: display_name
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(tel\\:[^>]*>)([0-9\\s\\+\\-\\/\\(\\)]*)((?:[^>]*>){4}M<)"
            type: 1
            typeOfInfo: cellular_telephone1
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(tel\\:[^>]*>(?:[^>]*>))([0-9\\s\\+\\-\\/\\(\\)]*)((?:[^>]*>){4}H<)"
            type: 1
            typeOfInfo: telephone_home1
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(tel\\:[^>]*>(?:[^>]*>))([0-9\\s\\+\\-\\/\\(\\)]*)((?:[^>]*>){4}W<)"
            type: 1
            typeOfInfo: telephone_business1
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(mailto[^>]*>)([^<]*)((?:[^>]*>){2}<\\/a>)"
            type: 1
            typeOfInfo: email2
          - !com.openexchange.subscribe.crawler.internal.PagePart
            regex: "(mailto[^>]*>)([^<]*)((?:[^>]*>){4}W<)"
            type: 1
            typeOfInfo: email1
          - !com.openexchange.subscribe.crawler.internal.PagePart
            keepStringAfterMatching: true
            regex: "(Address(?:[^>]*>){3})([^<]*)((?:[^>]*>){4}H<)"
            type: 1
            typeOfInfo: address_note
          - !com.openexchange.subscribe.crawler.internal.PagePart
            keepStringAfterMatching: true
            regex: "(Address(?:[^>]*>){15})([^<]*)((?:[^>]*>){4}W<)"
            type: 1
            typeOfInfo: address_note
          - !com.openexchange.subscribe.crawler.internal.PagePart
            keepStringAfterMatching: true
            regex: "(Birthday(?:[^>]*>){3})([^\\s<]*)()"
            type: 1
            typeOfInfo: birthday_month_string
          - !com.openexchange.subscribe.crawler.internal.PagePart
            keepStringAfterMatching: true
            regex: "(Birthday(?:[^>]*>){3}[^0-9]*)([0-9]*)()"
            type: 1
            typeOfInfo: birthday_day
          - !com.openexchange.subscribe.crawler.internal.PagePart
            keepStringAfterMatching: true
            regex: "(Birthday(?:[^>]*>){3}[^,]*,\\s)([0-9]*)(<)"
            type: 1
            typeOfInfo: birthday_year
  
